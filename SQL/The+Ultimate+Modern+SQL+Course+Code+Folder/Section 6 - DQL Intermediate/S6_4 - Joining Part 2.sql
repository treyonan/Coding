USE ROLE SYSADMIN;
USE WAREHOUSE XSMALL_WAREHOUSE;
USE SCHEMA SNOWFLAKE_SAMPLE_DATA.TPCH_SF1;

-- LEFT-OUTER JOIN: "Which customers have not placed any orders?"
SELECT 
    C.C_CUSTKEY, C.C_NAME
FROM 
    CUSTOMER C
LEFT JOIN ORDERS O ON C.C_CUSTKEY = O.O_CUSTKEY
WHERE 
    O.O_ORDERKEY IS NULL;

-- RIGHT-OUTER JOIN: "Which orders do not have a corresponding customer?"
SELECT 
    C.C_CUSTKEY, C.C_NAME, O.O_ORDERKEY
FROM 
    CUSTOMER C
RIGHT JOIN ORDERS O ON C.C_CUSTKEY = O.O_CUSTKEY
WHERE 
    C.C_CUSTKEY IS NULL;

-- FULL-OUTER JOIN: "What is the total amount generated by each customer, including customers without orders and orders without customers?"
SELECT 
    C.C_CUSTKEY, SUM(O.O_TOTALPRICE) AS TOTAL_AMOUNT
FROM 
    CUSTOMER C
FULL OUTER JOIN ORDERS O ON C.C_CUSTKEY = O.O_CUSTKEY
GROUP BY 
    C.C_CUSTKEY
ORDER BY 
    TOTAL_AMOUNT DESC NULLS LAST;

-- CROSS JOIN
SELECT 
    C.C_CUSTKEY, C.C_NAME, N.N_NAME
FROM 
    CUSTOMER C
CROSS JOIN NATION N;

