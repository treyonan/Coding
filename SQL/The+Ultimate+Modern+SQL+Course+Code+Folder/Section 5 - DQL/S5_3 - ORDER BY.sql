USE ROLE SYSADMIN;
USE SCHEMA DEMO_DB.DEMO_SCHEMA;
USE WAREHOUSE XSMALL_WAREHOUSE;

-- Sorting string values
SELECT 
    DIRECTOR_NAME, RUNTIME
FROM 
    MOVIE
WHERE 
    RUNTIME >= 170 
ORDER BY 
    DIRECTOR_NAME; -- sort key

SELECT 
    $1 AS STRING_CHARACTER, 
    ASCII(STRING_CHARACTER)
FROM 
    (VALUES('A'), ('T'));
  

SELECT 
    DIRECTOR_NAME, RUNTIME
FROM 
    MOVIE
WHERE 
    RUNTIME >= 170
ORDER BY 
    1;

-- Sorting numeric values
SELECT 
    DIRECTOR_NAME, GROSS
FROM 
    MOVIE
WHERE 
    RUNTIME >= 170
ORDER BY 
    GROSS; 


-- Sorting temporal values
SELECT 
    DIRECTOR_NAME, RELEASE_DATE
FROM 
    MOVIE
WHERE 
    RUNTIME >= 170
ORDER BY 
    RELEASE_DATE; 

-- Ascending
SELECT 
    DIRECTOR_NAME, RELEASE_DATE
FROM 
    MOVIE
WHERE 
    RUNTIME >= 170
ORDER BY 
    RELEASE_DATE ASC; 

-- Descending
SELECT 
    DIRECTOR_NAME, RELEASE_DATE
FROM 
    MOVIE
WHERE 
    RUNTIME >= 170
ORDER BY 
    RELEASE_DATE DESC;

-- What are the top 10 grossing films? 
SELECT 
    TITLE, GROSS
FROM 
    MOVIE
ORDER BY 
    GROSS DESC
LIMIT 10;  

-- NULLS
UPDATE MOVIE
SET GENRE = NULL
WHERE MOVIE_ID IN (477, 32, 833, 118);

SELECT DISTINCT
    GENRE
FROM 
    MOVIE
ORDER BY 
    GENRE;

-- NULLS FIRST 
SELECT DISTINCT
    GENRE
FROM 
    MOVIE
ORDER BY 
    GENRE NULLS FIRST;

-- NULLS LAST
SELECT DISTINCT
    GENRE
FROM 
    MOVIE
ORDER BY 
    GENRE DESC NULLS LAST;